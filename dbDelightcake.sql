CREATE DATABASE DELIGHTCAKEdb
GO

USE DELIGHTCAKEdb
GO

CREATE TABLE CLIENTE (
    IDCLI int identity (1,1) PRIMARY KEY,
    NOMCLI Varchar(50)  NOT NULL,
    APECLI Varchar(50)  NOT NULL,
	DNICLI char(8)  NOT NULL,
    TELCLI char(9)  NOT NULL,
    EMACLI Varchar(60)  NOT NULL,
    ESTCLI char(1)  NOT NULL,
    CODUBI char (6)  NOT NULL,
	DOMCLI VARCHAR(50));
GO

CREATE TABLE PRODUCTO (
    IDPRO int identity (1,1) PRIMARY KEY,
    NOMPRO varchar(50)  NOT NULL,
    PREPRO decimal(5,2)  NOT NULL,
    DESPRO varchar(250)  NOT NULL,
	ESTPRO char(1)  NOT NULL,
	STOPRO int NOT NULL);
GO

CREATE TABLE UBIGEO (
    CODUBI CHAR(6) PRIMARY KEY,
    DEPUBI varchar(50)  NOT NULL,
    PROUBI varchar(50)  NOT NULL,
    DISUBI varchar(70)  NOT NULL);
GO

ALTER TABLE CLIENTE ADD CONSTRAINT CLIENTE_UBIGEO
    FOREIGN KEY (CODUBI)
    REFERENCES UBIGEO (CODUBI);

INSERT INTO UBIGEO
	(CODUBI,DEPUBI, PROUBI,DISUBI)
	VALUES
	('150501','LIMA','CAÑETE','SAN VICENTE DE CAÑETE'),
	('150502','LIMA','CAÑETE','ASIA'),
	('150503','LIMA','CAÑETE','CALANGO'),
	('150504','LIMA','CAÑETE','CERRO AZUL'),
	('150505','LIMA','CAÑETE','CHILCA'),
	('150506','LIMA','CAÑETE','COAYLLO'),
	('150507','LIMA','CAÑETE','IMPERIAL'),
	('150508','LIMA','CAÑETE','LUNAHUANA'),
	('150509','LIMA','CAÑETE','MALA'),
	('150510','LIMA','CAÑETE','NUEVO IMPERIAL'),
	('150511','LIMA','CAÑETE','PACARAN'),
	('150512','LIMA','CAÑETE','QUILMANA'),
	('150513','LIMA','CAÑETE','SAN ANTONIO'),
	('150514','LIMA','CAÑETE','SAN LUIS'),
	('150515','LIMA','CAÑETE','SANTA CRUZ DE FLORES'),
	('150516','LIMA','CAÑETE','ZUÑIGA');
GO

INSERT INTO CLIENTE
	(NOMCLI,APECLI,DNICLI,TELCLI,EMACLI,ESTCLI,CODUBI,DOMCLI)
	VALUES
	('DANIEL','LOPEZ CANCHARI','76234902','920087382','Daniel_lopez@hotmail.com','A','150501','2 DE MAYO'),
	('MIGYEL','FLORES MIX','62386386','973821232','Migyel.Flores@hotmail.com','A','150502','29 DE JULIO'),
	('MARIO', 'MAMADI GUTIERRES','57367287','914215788','MamadiGutierre@hotmail.com','A','150502','2 DE MAYO'),
	('JOSE','MAXMA LINGA','56486287','996545788','Maxmalinga@hotmail.com','I','150503','2 DE MAYO'),
	('MARIA','BROS GONZALES','74623287','996215248','Maria_10@hotmail.com','A','150505','2 DE MAYO'),
	('LUIS','MELAZCO MARUIN','65402343','912215788','Melazco12@hotmail.com','I','150503','2 DE MAYO'),
	('FERNANDO','REINA MIMADI','78728723','996546788','Fernando.Mimadi@hotmail.com','I','150505','2 DE MAYO'),
	('ESTEBAN','PIXILIONGO MIZERO','45232302','995615788','Pixiliongo@hotmail.com','I','150503','2 DE MAYO'),
	('PEDRO', 'CANCHARI MAXMA','42105213','964561718','Canchari_Maxma@hotmail.com','A','150501','2 DE MAYO'),
	('FRANCO','LOREX HUAMAN','4051902','996215745','Lorex.12@hotmail.com','A','150502','2 DE MAYO'),
	('MARCO', 'DIAZ MARTINEZ','34309021','976215732','MarcoMartinez@hotmail.com','I','150504','2 DE MAYO'),
	('STAR','VALIAS FLORES','67228702','944575785','Flores.123@hotmail.com','A','150505','2 DE MAYO'),
	('BLANCA','FLORES ACEVEDO','98326102','996223586','BlancaFlores@hotmail.com','I','150506','2 DE MAYO'),
	('ROSA','MAXI MARUA','76422102','996248478','maruaRosa@hotmail.com','A','150502','2 DE MAYO'),
	('MANUEL','LOPEZ MAXIMA','34234533','996254788','MaximaManuel@hotmail.com','A','150503','2 DE MAYO'),
	('DIEGO','CANCHARI MATAMA','68089027','946815783','Canchari@hotmail.com','A','150504','2 DE MAYO'),
	('MARIO','BERROCAL ZENTENO','40845501','996286468','BerrocalMario@hotmail.com','I','150505','2 DE MAYO'),
	('LUIS','LOPEZ SANCHEZ','51234902','993155782','LopezSanchez@hotmail.com','I','150507','2 DE MAYO'),
	('XIMENA','LOPEZ CANCHARI','40254502','965415718','Ximena@hotmail.com','I','150508','2 DE MAYO'),
	('MAXIMO','CANCHARI SIERRA','77343233','985215788','Maximo@hotmail.com','I','150501','2 DE MAYO');
GO

INSERT INTO PRODUCTO
	(NOMPRO, PREPRO,DESPRO,ESTPRO,STOPRO)
	VALUES
	('TORTA DE CHOCOLATE', '57.0', 'SI DESEA ENDULZAR SU VIDA COMPRE SU RICA TORTA DE CHOCOLATE.','A','20'),
	('TORTA DE VAINILLA', '54.0','ES UNA TORTA ESPONJOSA','A','10'),
	('TORTA MARMOLEADO', '55.0','ES UN PASTEL DULCE CONTINE COCOA Y CACAO.','A','6'), 
	('TORTA DE TRES LECHES', '50.0','CONSISTE EN UN BISCOCHO BAÑADO CON TRES TIPOS DE LECHE ','A','2'),
	('TORTA DE NARANJA', '40.0','CONTIENE LOS SABORES DEL JUGO DE NARANJA, RALLADURA DE LA CASCARA Y ESENCIA DE NARANJA.','A','2'),  
	('TORTA HELADA', '45.0','TORTA HELADA ES TANTO UN HELADO CON FORMA DE TORTA.','A','9'),  
	('TORTA DE SELVA NEGRA', '53.0','LA TORTA SELVA NEGRA ES UNA TARTA TIPICA DE COCINA DE BADEN.','A','2'),
	('QUEQUE DE NARANJA',' 41.0', 'ES UN DELICIOSO Y CONTIENE NARANJA QUE TIENE PROPIEDADES BENIFICIOSOS.','A','2'),
	('QUEQUE DE LIMON', '43.0', 'ES UN QUEQUE FORMADA POR UNA BASE DE CREMA DE LIMON.','A','2'),
	('QUEQUE DE PIÑA', '35.0', 'ESTE ES UN DELICIOSO QUEQUE CON UN CUBIERTO DE CARAMELO.','A','2'),
	('QUEQUE INGLES',' 43.0','ESTA PREPARADA CON FRUTAS CON FRUTAS SECAS Y NUECES.','A','8'),
	('QUEQUE CHIFFON', '45.0','ES UN QUEQUE MUY LIGERO.','I','2'),
	('PIE DE MANZANA', '50.0','CONSISTE EN UNA MASA SUAVE Y CRUJIENTE DE MANZANAS.','A','2'),
	('ALFAJORES', '16.0','ESTA RELLENAS DE JALEAS.','I','2'),
	('CUPCAKES', '21.0', 'ES UNA PEQUEÑA TARTA INDIVIDUAL.','I','2'),
	('EMPANADA','23.0','ESTA EMPANADA INCLUYE FRUTAS.','I','2'),
	('QUEQUE DE CAFE', '54.0','ESTE TIPO DE QUEQUE INCLUYE EL FUERTE SABOR AL CAFE COMO PARTE DE SU PERFIL DE SABOR.','I','2'),
	('QUEQUE MARMOLADO', '23.0','ESTA COMPUESTO POR UN BIZCOCHO DE VAINILLA Y UNA DE CHOCOLATE.','A','2'),
	('QUEQUE DE MANDARINA','15.0','SE TRATA DE UN QUEQUE FACIL Y ESPONJOSO.','I','2'),
	('QUEQUE CON LECHE CONDENSADA','25.0','ESTE QUEQUE CON LECHE CONDESADA ES SENCILLA Y DELICIOSA.','A','2');
GO

CREATE VIEW vPRODUCTO
AS
SELECT
	 P.IDPRO AS IDPRO,
     P.NOMPRO AS NOMPRO,
     P.PREPRO AS PREPRO,
	 P.DESPRO AS DESPRO,
	 P.STOPRO AS STOPRO,
     P.ESTPRO AS ESTPRO,
	 ROW_NUMBER() OVER (ORDER BY P.IDPRO DESC) AS ORDEN
FROM 
     PRODUCTO P
GO

CREATE VIEW vCLIENTE
AS
SELECT
	 C.IDCLI AS IDCLI,
	 SUBSTRING(UPPER(C.NOMCLI),1,1) + SUBSTRING(LOWER(C.NOMCLI),2,50) AS NOMCLI,
	 SUBSTRING(UPPER(C.APECLI),1,1) + SUBSTRING(LOWER(C.APECLI),2,50) AS APECLI,
	 SUBSTRING(UPPER(C.DOMCLI),1,1) + SUBSTRING(LOWER(C.DOMCLI),2,50) AS DOMCLI,
	 C.DNICLI AS DNICLI,
	 C.EMACLI AS EMACLI,
	 C.TELCLI AS TELCLI,
	 C.ESTCLI AS ESTCLI,
	 U.CODUBI AS CODUBI,
	 U.DISUBI AS DISUBI,
	 U.PROUBI AS PROUBI,
	 U.DEPUBI AS DEPUBI,
	 ROW_NUMBER() OVER (ORDER BY C.IDCLI DESC) AS ORDEN
FROM 
     CLIENTE AS C
	 INNER JOIN UBIGEO AS U ON
	 C.CODUBI = U.CODUBI;
GO